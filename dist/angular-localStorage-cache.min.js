var SpeedShifter;!function(a){!function(a){a.LocalStorageProvider=["$log","$window",function(a,b){var c="undefined"==typeof b.localStorage?void 0:b.localStorage,d=!("undefined"==typeof c||"undefined"==typeof JSON);d||a.error("LocalStorage is not supported"),this.name="",this.config={};var e=this,f=this,g={get:function(a){if(!d)return null;var b=c.getItem(a);try{var e=JSON.parse(b);return"undefined"==typeof e&&(e=b),"true"===e?e=!0:"false"===e&&(e=!1),e}catch(f){return b}},set:function(a,b){if(!d)return null;try{c.setItem(a,JSON.stringify(b))}catch(e){throw console.error("localStorage LIMIT REACHED: ("+e+")"),e}return b},remove:function(a){return d?(c.removeItem(a),!0):!1}};this.$get=[function(){var a={},b=null;return a.get=function(c,d){var f=e.name+"."+c,h=f,i=e.config[c];if(d&&(h+="."+d),i){if(i.user_dependent){var j=g.get(f+".uid");if(!j||j!=b)return b&&a.remove(c),null}if(i.expires){var k=g.get(h+".updated");return k&&parseInt(k)>jQuery.now()-i.expires?g.get(h):(g.remove(h),null)}return g.get(h)}return g.get(h)},a.set=function(c,d,f,h){var i=e.name+"."+c,j=i,k=e.config[c];d&&(j+="."+d);try{if(k){if(k.user_dependent&&g.set(i+".uid",b),k.multiple&&k.limit){var l=g.get(i+".count");if(l=parseInt(l)||0,l>=k.limit)return;g.set(i+".count",l+1)}g.set(j,f),k.expires&&g.set(j+".updated",h||jQuery.now())}else g.set(j,f)}catch(m){if(k&&k.multiple){var n=500;k.limit&&(n=Math.floor(k.limit/2)),a.remove(c,null,n)}}},a.remove=function(a,b,d){var f=e.name+"."+a,h=f,i=e.config[a];if(b&&(h+="."+b),i)if(i.multiple&&!b){var j,k=0;i.user_dependent&&(d=null);for(var l=0;l<c.length&&(j=c.key(l),!(0==j.indexOf(f)&&(g.remove(j),l--,console.log("remove",j,f),d&&++k>=d)));l++);i.limit&&g.set(f+".count",Math.max(g.get(f+".count")-k,0))}else f+=b?"."+b:"",g.remove(h),i.limit&&g.set(f+".count",Math.max(g.get(f+".count")-1,0)),i.user_dependent&&g.remove(f+".uid"),i.expires&&g.remove(h+".updated");else g.remove(h),i.limit&&g.set(f+".count",Math.max(g.get(f+".count")-1,0)),i.user_dependent&&g.remove(f+".uid"),i.expires&&g.remove(h+".updated")},a.setUserId=function(c){if(!angular.isUndefined(c)&&""!==c&&null!==c&&c===c){var d=c;if(angular.isObject(c))try{d=angular.toJson(c)}catch(f){}b=""+d;var h,i,j=e.config;for(i in j)j[i].user_dependent&&(h=e.name+"."+i,g.get(h+".uid")!=b&&a.remove(i))}},a}],f.setAppName=function(a){this.name=a},f.addStoreConfig=function(a){this.config[a.valueName]=a}}]}(a.Services||(a.Services={}));a.Services}(SpeedShifter||(SpeedShifter={}));var SpeedShifter;!function(a){!function(){var b=angular.module("speedshifter.localStoragePromise")||angular.module("speedshifter.localStoragePromise",[]);b.provider("localStoragePromise",a.Services.LocalStorageProvider)}(a.Services||(a.Services={}));a.Services}(SpeedShifter||(SpeedShifter={}));